// ğŸ”— æœ€åˆçš„æ€è·¯
    // 2sumé—®é¢˜ æ˜¯ å»ºç«‹ æ•°ç»„ä¸­æ¯ä¸ªæ•°å¯¹Targetçš„å·® åˆ° å¯¹idx çš„æ˜ å°„ï¼Œæœ¬è´¨ä¸Šæ˜¯é€†å‘æ€ç»´çš„ä½“ç°ï¼Œå°†é—®é¢˜ä» æ­£å‘æ‰¾å’Œ åˆ° é€†å‘è®°å·® çš„è½¬å˜ã€‚
    // ä» 2sumé—®é¢˜ å‡ºå‘ï¼Œæ‹“å±•åˆ° 3sumé—®é¢˜ é—®é¢˜çš„å…³é”®åœ¨äºç»§ç»­æ²¿ç”¨é€†å‘æ€ç»´ -> å‡è®¾å·²ç»æ‰¾åˆ°äº†æŸä¸ª 2sumï¼Œç°åœ¨æˆ‘ä»¬åªéœ€è¦åœ¨å‰©ä¸‹çš„æ•°ç»„ä¸­æ‰¾åˆ°ä¸€ä¸ªå€¼ v æ»¡è¶³ 2sum + v == targetï¼Œä¹Ÿå°±æ˜¯å»ºç«‹ target - v åˆ° å¯¹åº”idx çš„æ˜ å°„ -> ç„¶åé—®é¢˜è½¬åŒ–ä¸º 2sumé—®é¢˜ã€‚
    // ä» 3sumé—®é¢˜è§¦å‘ï¼Œæ‹“å±•åˆ° 4sumé—®é¢˜ åŒ 3sumé—®é¢˜ï¼Œä¸€æ ·çš„é€†å‘æ€ç»´ï¼Œå…ˆå»ºç«‹ ç¬¬å››ä¸ªæ•°å€¼ çš„Targetå·®æ˜ å°„ï¼Œç„¶åæ˜¯ ç¬¬ä¸‰ä¸ªæ•°å€¼ï¼Œä»¥æ­¤ç±»æ¨ã€‚
// âŒ ä½ æå‡ºçš„â€œå»ºç«‹æ˜ å°„â€æ€è·¯åœ¨ 2Sum ä¸­æ˜¯éå¸¸å®Œç¾çš„ï¼ˆç”¨ç©ºé—´æ¢æ—¶é—´ï¼‰ã€‚ä½†åœ¨ 3Sum å’Œ 4Sum ä¸­ï¼Œå¦‚æœç»§ç»­ä½¿ç”¨ unordered_map æ¥å­˜å‚¨å·®å€¼ï¼Œä¼šé‡åˆ°ä¸¤ä¸ªè‡´å‘½é—®é¢˜ï¼š
    // 1. å»é‡å›°éš¾ï¼ˆæœ€éº»çƒ¦çš„ç‚¹ï¼‰ï¼šé¢˜ç›®è¦æ±‚è¿”å›â€œä¸é‡å¤çš„å››å…ƒç»„â€ã€‚å“ˆå¸Œè¡¨ä¸¢å¤±äº†é¡ºåºä¿¡æ¯ï¼Œ[-1, 0, 1, 2] å’Œ [0, -1, 2, 1] åœ¨å“ˆå¸Œè¡¨ä¸­å¾ˆéš¾åˆ¤æ–­ä¸ºåŒä¸€ä¸ªè§£ï¼Œé™¤éä½ å¯¹ç»“æœå†è¿›è¡Œä¸€æ¬¡ç¹ççš„æ’åºå»é‡ã€‚
    // 2. Key å†²çªï¼šum_v2 ä¸­å¦‚æœæœ‰å¤šä¸ªç»„åˆéƒ½èƒ½å‡‘å‡ºåŒä¸€ä¸ªå·®å€¼ï¼Œmap ä¼šè¦†ç›–æ‰å‰é¢çš„ç´¢å¼•ï¼Œå¯¼è‡´ä½ æ¼æ‰è§£ã€‚
// â— æ­£ç¡®çš„â€œé™ç»´æ‰“å‡»â€ç­–ç•¥
    // å¯¹äº K-Sum (K > 2) é—®é¢˜ï¼Œä¸šç•Œçš„æ ‡å‡†è§£æ³•æ˜¯å°†é—®é¢˜å±‚å±‚é™ç»´ï¼Œä½†ä¸ç”¨å“ˆå¸Œè¡¨ï¼Œè€Œæ˜¯ç”¨ æ’åº + åŒæŒ‡é’ˆã€‚
    // 4Sumï¼šå›ºå®š iï¼Œé—®é¢˜å˜ä¸ºåœ¨å‰©ä½™æ•°ç»„ä¸­æ‰¾ 3Sumã€‚
    // 3Sumï¼šå›ºå®š jï¼Œé—®é¢˜å˜ä¸ºåœ¨å‰©ä½™æ•°ç»„ä¸­æ‰¾ 2Sumã€‚
    // 2Sumï¼šåœ¨æœ‰åºæ•°ç»„ä¸­ï¼Œç”¨åŒæŒ‡é’ˆ L å’Œ R å¿«é€Ÿæ‰¾åˆ° targetã€‚
    // è¿™ä¾ç„¶æ˜¯ä½ è¯´çš„â€œé€†å‘æ€ç»´â€ï¼ˆTarget - nums[i]ï¼‰ï¼Œä½†ç”¨åŒæŒ‡é’ˆä»£æ›¿å“ˆå¸Œè¡¨æ¥è§£å†³å»é‡å’Œè¦†ç›–é—®é¢˜ã€‚
// â­ ä½ æœ€åˆçš„ä»£ç è¯•å›¾é€šè¿‡ç¼“å­˜ä¸­é—´ç»“æœï¼ˆMapï¼‰æ¥åŠ é€Ÿï¼Œè¿™åœ¨å¾ˆå¤šç®—æ³•é¢˜ä¸­æ˜¯é«˜é˜¶æŠ€å·§ï¼ˆå¦‚åŠ¨æ€è§„åˆ’ï¼‰ã€‚ä½†åœ¨ K-Sum é—®é¢˜ä¸­ï¼Œç”±äºå»é‡æ˜¯æ ¸å¿ƒéš¾ç‚¹ï¼Œæ’åº+åŒæŒ‡é’ˆæ‰æ˜¯è¿™ä¸€ç±»é—®é¢˜çš„â€œé€šè§£â€ã€‚
#include <vector>
#include <algorithm>

using namespace std;

class Solution {
public:
    vector<vector<int>> fourSum(vector<int>& nums, int target) {
        vector<vector<int>> ans;
        int n = nums.size();
        if (n < 4) return ans;

        // 1. æ ¸å¿ƒæ­¥éª¤ï¼šæ’åº
        // æ’åºæ˜¯ä¸ºäº†æ–¹ä¾¿å»é‡ï¼Œä»¥åŠä½¿ç”¨åŒæŒ‡é’ˆ
        sort(nums.begin(), nums.end());

        // 2. ç¬¬ä¸€å±‚å¾ªç¯ï¼šå›ºå®šç¬¬ä¸€ä¸ªæ•° a (ç´¢å¼• i)
        for (int i = 0; i < n - 3; ++i) {
            // å»é‡ï¼šå¦‚æœæˆ‘ä»¬å·²ç»å¤„ç†è¿‡è¿™ä¸ªæ•°ä½œä¸ºç¬¬ä¸€ä¸ªæ•°ï¼Œè·³è¿‡
            if (i > 0 && nums[i] == nums[i - 1]) continue;

            // å‰ªæ 1ï¼šå½“å‰æœ€å°çš„å››ä¸ªæ•°ä¹‹å’Œéƒ½å¤§äº targetï¼Œåé¢ä¸å¯èƒ½æœ‰è§£äº†ï¼Œç›´æ¥ç»“æŸ
            // æ³¨æ„ï¼šä½¿ç”¨ long long é˜²æ­¢æº¢å‡ºï¼Œé¢˜ç›®æç¤º target å’Œ nums[i] è¾ƒå¤§
            if ((long long)nums[i] + nums[i + 1] + nums[i + 2] + nums[i + 3] > target) break;

            // å‰ªæ 2ï¼šå½“å‰æ•°åŠ ä¸Šæœ€å¤§çš„ä¸‰ä¸ªæ•°éƒ½å°äº targetï¼Œè¯´æ˜ nums[i] å¤ªå°äº†ï¼Œè¿™ä¸€è½®æ²¡æˆï¼Œçœ‹ä¸‹ä¸€ä¸ª i
            if ((long long)nums[i] + nums[n - 3] + nums[n - 2] + nums[n - 1] < target) continue;

            // 3. ç¬¬äºŒå±‚å¾ªç¯ï¼šå›ºå®šç¬¬äºŒä¸ªæ•° b (ç´¢å¼• j)
            for (int j = i + 1; j < n - 2; ++j) {
                // å»é‡ï¼šå¯¹äºå½“å‰çš„ iï¼Œå¦‚æœ nums[j] é‡å¤äº†ï¼Œè·³è¿‡
                if (j > i + 1 && nums[j] == nums[j - 1]) continue;

                // äºŒçº§å‰ªæï¼šåŒç†
                if ((long long)nums[i] + nums[j] + nums[j + 1] + nums[j + 2] > target) break;
                if ((long long)nums[i] + nums[j] + nums[n - 2] + nums[n - 1] < target) continue;

                // 4. åŒæŒ‡é’ˆï¼šå¯»æ‰¾ c (left) å’Œ d (right) â€”â€” æœ¬è´¨å°±æ˜¯è§£å†³ 2Sum
                int left = j + 1;
                int right = n - 1;
                while (left < right) {
                    long long sum = (long long)nums[i] + nums[j] + nums[left] + nums[right];

                    if (sum == target) {
                        ans.push_back({nums[i], nums[j], nums[left], nums[right]});
                        
                        // æ‰¾åˆ°ç­”æ¡ˆåï¼Œç»§ç»­æ”¶ç¼©æŒ‡é’ˆï¼ŒåŒæ—¶è·³è¿‡é‡å¤å…ƒç´ ï¼ˆå»é‡å…³é”®ï¼‰
                        while (left < right && nums[left] == nums[left + 1]) left++;
                        while (left < right && nums[right] == nums[right - 1]) right--;
                        
                        left++;
                        right--;
                    } else if (sum < target) {
                        left++; // å’Œå¤ªå°ï¼Œå·¦æŒ‡é’ˆå³ç§»
                    } else {
                        right--; // å’Œå¤ªå¤§ï¼Œå³æŒ‡é’ˆå·¦ç§»
                    }
                }
            }
        }
        return ans;
    }
};
